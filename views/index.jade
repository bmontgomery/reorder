script
	var container,
			txtName,
			btnAdd,
			btnSave,
			itemDataKey = 'itemData',
			listID = '';

	$(function(){
			container = $('#container');
			txtName = $('#txtName');
			btnAdd = $('#btnAdd');
			btnSave = $('#btnSave');

			txtName.focus();

			container.sortable();

			txtName.on('keypress', btnAdd_KeyPress);
			btnAdd.on('click', btnAdd_Click);

			$('div.close-button').live('click', removeItem);

			btnSave.on('click', btnSave_Click);
	});

	function btnAdd_KeyPress(e) {
		e = e || window.event;
		if (e.keyCode === 13) {
			btnAdd.trigger('click');
		}
	}

	function btnAdd_Click(e) {
		if (txtName.val() !== '') {
			makeItem(txtName.val()).appendTo('#container');
			txtName.val('');
		}
	}

	function makeItem(name) {
		var itemData = { name: txtName.val() };
		return $('#item').tmpl( itemData ).data(itemDataKey, itemData);
	}

	function removeItem(e) {
		e = e || window.event;
		$(e.target).closest('div.item').remove();
	}

	function btnSave_Click(e) {
		e = e || window.event;
		var items = [];
		container.find('div.item').each(function( index, item ) {
			items.push( $(item).data( itemDataKey ) );
		});
		if (items.length > 0) {
			$.ajax({
				type: 'POST',
				contentType: 'application/json;charset=utf-8',
				data: JSON.stringify({ id: listID, items: items }),
				dataType: 'json',
				success: function( data ) {
					if (data && data.data) {
						if (listID) {
							$('#link').text('Your list has been saved.');
						} else {
							$('#link').html('');
							$('#linkTemplate').tmpl(data.data).appendTo('#link');
							$('#link').show();
							listID = data.data.id;
						}
					}
				}
			});
		} else {
			alert('There are no items to save, silly!');
		}
	}

script#item(type="text/x-jquery-template")
	<div class="item">
	${name}
	<div class="close-button">X</div>
	</div>

script#linkTemplate(type="text/x-jquery-template")
	| Your list is available here: ${id}

h1= title
p Welcome to #{title}. Go for it.
p#link
input#txtName(type="text")
input#btnAdd(type="button", value="Add")
input#btnSave(type="button", value="Save")
div#container
